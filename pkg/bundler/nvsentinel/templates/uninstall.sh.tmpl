#!/bin/bash
# NVSentinel Uninstallation Script
# Generated by CNS Eidos
# Timestamp: {{ .Timestamp }}
# Bundler Version: {{ .Version }}

set -e

echo "Uninstalling NVSentinel..."

# Uninstall Helm release
echo "Uninstalling NVSentinel Helm release..."
helm uninstall {{ .HelmReleaseName.Value }} -n {{ .Namespace }} || true

# Wait for cleanup
echo "Waiting for resources to be cleaned up..."
sleep 10

# Optionally delete namespace
read -p "Do you want to delete the namespace {{ .Namespace }}? (y/N) " -n 1 -r
echo
if [[ $REPLY =~ ^[Yy]$ ]]; then
    kubectl delete namespace {{ .Namespace }} --ignore-not-found=true
    echo "Namespace {{ .Namespace }} deleted."
else
    echo "Namespace {{ .Namespace }} preserved."
fi

echo "NVSentinel uninstallation complete!"
