# Skyhook Operator Template
# Generated by CNS Eidos
# Timestamp: {{ .Timestamp }}
# Bundler Version: {{ .Version }}
# Recipe Version: {{ .RecipeVersion }}

apiVersion: skyhook.nvidia.com/v1alpha1
kind: Skyhook
metadata:
  labels:
    app.kubernetes.io/part-of: skyhook-operator
    app.kubernetes.io/created-by: skyhook-operator
  name: {{ .Name }}
spec:
  runtimeRequired: {{ .RuntimeRequired }}
  additionalTolerations:
    - key: {{ .TolerationKey }}
      operator: Exists
  interruptionBudget:
    percent: {{ .InterruptionBudgetPercent }}
  nodeSelectors:
    matchExpressions:
      - key: {{ .NodeSelectorKey }}
        operator: In
        values:
{{- range .NodeSelectorValues }}
          - {{ . }}
{{- end }}
  packages:
    tuning:
      version: {{ .TuningVersion }}
      image: {{ .TuningImage }}
      configInterrupts:
        grub.conf:
          type: reboot
        service_containerd.conf:
          type: service
          services: ["containerd"]
        sysctl.conf:
          type: reboot
      interrupt: 
        type: {{ .TuningInterruptType }}
      configMap:
        grub.conf: |-
{{ .GrubConfig }}
        service_containerd.conf: |-
{{ .ContainerdServiceConfig }}
        sysctl.conf: |-
{{ .SysctlConfig }}
