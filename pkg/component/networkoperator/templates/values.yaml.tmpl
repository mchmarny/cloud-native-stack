# Network Operator Helm Values
# Generated from Cloud Native Stack Recipe
# Timestamp: {{ .Timestamp }}
# Bundler Version: {{ .Version }}
# Recipe Version: {{ .RecipeVersion }}

operator:
  {{- if .NetworkOperatorVersion }}
  tag: {{ .NetworkOperatorVersion }}
  {{- end }}

deployCR: true

ofedDriver:
  deploy: {{ .DeployOFED }}
  {{- if .OFEDVersion }}
  version: {{ .OFEDVersion }}
  {{- end }}

rdmaSharedDevicePlugin:
  deploy: {{ .EnableRDMA }}
  {{- if eq .EnableRDMA "true" }}
  config:
    resources:
      - name: rdma_shared_device
        rdmaHcaMax: 1000
  {{- end }}

sriovDevicePlugin:
  deploy: {{ .EnableSRIOV }}

nvIPAM:
  deploy: {{ .EnableIPAM }}
  {{- if eq .EnableIPAM "true" }}
  config:
    enableWebhook: false
  {{- end }}

secondaryNetwork:
  deploy: true
  multus:
    deploy: {{ .EnableMultus }}
  ipamPlugin:
    deploy: {{ .EnableWhereabouts }}

nicFeatureDiscovery:
  deploy: true

{{- if .CustomLabels }}
nodeAffinity:
  requiredDuringSchedulingIgnoredDuringExecution:
    nodeSelectorTerms:
    - matchExpressions:
      {{- range $key, $value := .CustomLabels }}
      - key: {{ $key }}
        operator: In
        values:
        - {{ $value }}
      {{- end }}
{{- end }}

{{- if .Namespace }}
namespace: {{ .Namespace }}
{{- end }}

# NIC Feature Discovery Configuration
nfd:
  enabled: true
  deployNodeFeatureRules: true

# Container Runtime
containerRuntime:
  socket: {{ .ContainerRuntimeSocket }}
